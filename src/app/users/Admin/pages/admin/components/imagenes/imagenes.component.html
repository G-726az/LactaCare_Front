<div class="imagenes-container">
  <div class="section-header">
    <h2>Gesti√≥n de Im√°genes del Sistema</h2>
    <button class="btn-primary" (click)="abrirModalNuevo()">
      ‚ûï Nueva Imagen
    </button>
  </div>

  <div class="info-banner">
    <span class="icon">üñºÔ∏è</span>
    <p>Administra todas las im√°genes del sistema organizadas por categor√≠as</p>
  </div>

  <!-- FILTROS -->
  <div class="filtros-section">
    <input 
      type="text" 
      placeholder="üîç Buscar im√°genes..." 
      [(ngModel)]="busqueda"
      (input)="filtrarImagenes()"
      aria-label="Buscar im√°genes"
    >
    <select [(ngModel)]="categoriaFiltro" (change)="filtrarImagenes()" aria-label="Filtrar por categor√≠a">
      <option value="">Todas las categor√≠as</option>
      <option value="Banner">Banner</option>
      <option value="Educativo">Educativo</option>
      <option value="Promocional">Promocional</option>
      <option value="Informativo">Informativo</option>
      <option value="Decorativo">Decorativo</option>
    </select>
  </div>

  <!-- GRID DE IM√ÅGENES -->
  <div class="imagenes-grid">
    <div class="imagen-card" *ngFor="let imagen of imagenesFiltradas">
      <div class="card-image">
        <img 
          [src]="imagen.linkImagenes" 
          alt="Imagen del sistema" 
          title="Imagen del sistema"
          [attr.data-categoria]="imagen.categoriaImagenes"
          (error)="onImageError($event)"
        >
        <span class="categoria-badge">{{ imagen.categoriaImagenes }}</span>
      </div>
      
      <div class="card-actions">
        <button class="btn-icon" (click)="verImagen(imagen)" title="Ver imagen" aria-label="Ver imagen completa">üëÅÔ∏è</button>
        <button class="btn-icon" (click)="editarImagen(imagen)" title="Editar imagen" aria-label="Editar imagen">‚úèÔ∏è</button>
        <button class="btn-icon" (click)="eliminarImagen(imagen.id)" title="Eliminar imagen" aria-label="Eliminar imagen">üóëÔ∏è</button>
      </div>
    </div>
  </div>

  <!-- MODAL CREAR/EDITAR -->
  <div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h3>{{ modoEdicion ? 'Editar' : 'Nueva' }} Imagen</h3>
      
      <div class="form-group">
        <label for="categoriaImg">Categor√≠a *</label>
        <select id="categoriaImg" [(ngModel)]="imagenActual.categoriaImagenes" aria-label="Categor√≠a de imagen">
          <option value="">Selecciona una categor√≠a</option>
          <option value="Banner">Banner</option>
          <option value="Educativo">Educativo</option>
          <option value="Promocional">Promocional</option>
          <option value="Informativo">Informativo</option>
          <option value="Decorativo">Decorativo</option>
        </select>
      </div>

      <div class="form-group">
        <label for="urlImg">URL de la Imagen *</label>
        <input id="urlImg" type="url" [(ngModel)]="imagenActual.linkImagenes" placeholder="https://i.pinimg.com/736x/c3/08/80/c308801e4b7a1c9743c650299439b9f0.jpg">
        <p class="help-text">Ingresa la URL completa de la imagen</p>
      </div>

      <!-- VISTA PREVIA -->
      <div class="preview-section" *ngIf="imagenActual.linkImagenes">
        <label>Vista Previa</label>
        <img 
          [src]="imagenActual.linkImagenes" 
          alt="Vista previa de imagen" 
          title="Vista previa de imagen"
          class="image-preview"
          (error)="onImageError($event)"
        >
      </div>

      <div class="modal-actions">
        <button class="btn-secondary" (click)="cerrarModal()">Cancelar</button>
        <button class="btn-primary" (click)="guardarImagen()">Guardar</button>
      </div>
    </div>
  </div>

  <!-- MODAL VISOR DE IMAGEN -->
  <div class="modal-overlay" *ngIf="mostrarVisor" (click)="cerrarVisor()">
    <div class="modal-visor" (click)="$event.stopPropagation()">
      <button class="btn-close" (click)="cerrarVisor()" aria-label="Cerrar visor de imagen">‚úï</button>
      <img 
        [src]="imagenVisor?.linkImagenes || 'https://via.placeholder.com/400'" 
        alt="Imagen ampliada del sistema" 
        title="Imagen ampliada del sistema"
        class="imagen-completa"
        (error)="onImageError($event)"
      >
      <div class="visor-info" *ngIf="imagenVisor">
        <p><strong>ID:</strong> {{ imagenVisor.id }}</p>
        <p><strong>Categor√≠a:</strong> {{ imagenVisor.categoriaImagenes }}</p>
        <p><strong>URL:</strong> {{ imagenVisor.linkImagenes }}</p>
      </div>
    </div>
  </div>
</div>