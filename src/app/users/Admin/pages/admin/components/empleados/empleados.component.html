<div class="empleados-container">
  <div class="section-header">
    <h2>Gesti√≥n de Empleados</h2>
    <button class="btn-primary" (click)="abrirModalNuevo()">
      ‚ûï Nuevo Empleado
    </button>
  </div>

  <div class="filtros-section">
    <input 
      type="text" 
      placeholder="üîç Buscar empleado..." 
      [(ngModel)]="busqueda"
      (input)="filtrarEmpleados()"
      aria-label="Buscar empleado"
    >
    <select [(ngModel)]="rolFiltro" (change)="filtrarEmpleados()" aria-label="Filtrar por rol">
      <option value="">Todos los roles</option>
      <option value="M√©dico">M√©dico</option>
      <option value="Enfermera">Enfermera</option>
      <option value="Administrador">Administrador</option>
      <option value="T√©cnico">T√©cnico</option>
    </select>
    <select [(ngModel)]="estadoFiltro" (change)="filtrarEmpleados()" aria-label="Filtrar por estado">
      <option value="">Todos los estados</option>
      <option value="Activo">Activo</option>
      <option value="Inactivo">Inactivo</option>
    </select>
  </div>

  <div class="empleados-grid">
    <div class="empleado-card" *ngFor="let empleado of empleadosFiltrados">
      <div class="card-header">
        <img [src]="empleado.foto || 'assets/default-avatar.png'" alt="Empleado" class="empleado-foto">
        <div class="empleado-info">
          <h3>{{ empleado.nombre }}</h3>
          <span class="rol-badge" [style.background]="getRolColor(empleado.rol)">{{ empleado.rol }}</span>
        </div>
        <span class="estado-badge" [class.activo]="empleado.estado === 'Activo'">
          {{ empleado.estado }}
        </span>
      </div>
      
      <div class="card-body">
        <div class="info-item">
          <span class="icon">üìß</span>
          <span>{{ empleado.email }}</span>
        </div>
        <div class="info-item">
          <span class="icon">üìû</span>
          <span>{{ empleado.telefono }}</span>
        </div>
        <div class="info-item">
          <span class="icon">üè•</span>
          <span>{{ empleado.lactario }}</span>
        </div>
        <div class="info-item">
          <span class="icon">‚è∞</span>
          <span>{{ empleado.horario }}</span>
        </div>
      </div>

      <div class="card-footer">
        <button class="btn-icon" (click)="verDetalles(empleado)" title="Ver detalles">üëÅÔ∏è</button>
        <button class="btn-icon" (click)="editarEmpleado(empleado)" title="Editar">‚úèÔ∏è</button>
        <button class="btn-icon" (click)="eliminarEmpleado(empleado.id)" title="Eliminar">üóëÔ∏è</button>
      </div>
    </div>
  </div>

  <!-- MODAL CREAR/EDITAR -->
  <div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
    <div class="modal-content modal-large" (click)="$event.stopPropagation()">
      <h3>{{ modoEdicion ? 'Editar' : 'Nuevo' }} Empleado</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label>Nombre Completo *</label>
          <input type="text" [(ngModel)]="empleadoActual.nombre" placeholder="Ej: Dr. Juan P√©rez">
        </div>

        <div class="form-group">
          <label>Rol *</label>
          <select [(ngModel)]="empleadoActual.rol" aria-label="Rol del empleado">
            <option value="">Seleccione rol</option>
            <option value="M√©dico">M√©dico</option>
            <option value="Enfermera">Enfermera</option>
            <option value="Administrador">Administrador</option>
            <option value="T√©cnico">T√©cnico</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Email *</label>
          <input type="email" [(ngModel)]="empleadoActual.email" placeholder="empleado@ejemplo.com">
        </div>

        <div class="form-group">
          <label>Tel√©fono *</label>
          <input type="tel" [(ngModel)]="empleadoActual.telefono" placeholder="+593 99 123 4567">
        </div>
      </div>

      <div class="form-group">
        <label>C√©dula/DNI *</label>
        <input type="text" [(ngModel)]="empleadoActual.cedula" placeholder="0123456789">
      </div>

      <div class="form-group">
        <label>Lactario Asignado *</label>
        <select [(ngModel)]="empleadoActual.lactarioId" aria-label="Lactario asignado">
          <option value="">Seleccione lactario</option>
          <option *ngFor="let lac of lactarios" [value]="lac.id">{{ lac.nombre }}</option>
        </select>
      </div>

      <div class="form-group">
        <label>D√≠as Laborables</label>
        <div class="dias-checkboxes">
          <label *ngFor="let dia of diasSemana">
            <input type="checkbox" [(ngModel)]="empleadoActual.dias![dia.value]" [attr.aria-label]="'D√≠a ' + dia.label">
            <span>{{ dia.label }}</span>
          </label>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="empHoraInicio">Hora Inicio</label>
          <input type="time" id="empHoraInicio" [(ngModel)]="empleadoActual.horaInicio" aria-label="Hora de inicio">
        </div>

        <div class="form-group">
          <label for="empHoraFin">Hora Fin</label>
          <input type="time" id="empHoraFin" [(ngModel)]="empleadoActual.horaFin" aria-label="Hora de fin">
        </div>
      </div>

      <div class="form-group">
        <label>Estado</label>
        <select [(ngModel)]="empleadoActual.estado" aria-label="Estado del empleado">
          <option value="Activo">Activo</option>
          <option value="Inactivo">Inactivo</option>
        </select>
      </div>

      <div class="modal-actions">
        <button class="btn-secondary" (click)="cerrarModal()">Cancelar</button>
        <button class="btn-primary" (click)="guardarEmpleado()">Guardar</button>
      </div>
    </div>
  </div>
</div>