<div class="layout">
  <main class="content">
    <!-- --------------------------------------------------------- -->
    <!-- ğŸ” BARRA SUPERIOR                                         -->
    <!-- --------------------------------------------------------- -->
    <div class="top-bar">
      <h2 class="panel-title">Tu Asistente de Lactancia</h2>
      <button class="clear-btn" (click)="limpiarHistorial()" title="Limpiar historial">
        <i class="fas fa-trash-alt"></i>
      </button>
    </div>

    <!-- --------------------------------------------------------- -->
    <!-- ğŸ–¼ï¸ IMAGEN DE BIENVENIDA                                   -->
    <!-- --------------------------------------------------------- -->
    <div class="welcome-image">
      <img
        src="https://i.pinimg.com/1200x/c1/77/23/c17723d3f022cc8cf54c8fc5edb417d5.jpg"
        alt="Asistente Lactancia"
      />
    </div>

    <!-- --------------------------------------------------------- -->
    <!-- ğŸ’¬ HISTORIAL DE MENSAJES (DINÃMICO)                       -->
    <!-- --------------------------------------------------------- -->
    <div class="chat-history" #chatHistory>
      @for (mensaje of mensajes; track mensaje.id) {
      <div
        class="message"
        [class.bot]="mensaje.tipo === 'bot'"
        [class.user]="mensaje.tipo === 'user'"
      >
        <!-- âœ… Sin pipe, con CSS white-space: pre-wrap -->
        <p class="mensaje-texto">{{ mensaje.texto }}</p>
        <small class="timestamp">{{ mensaje.timestamp | date : 'short' }}</small>
      </div>
      }

      <!-- Indicador de "escribiendo..." -->
      @if (esperandoRespuesta) {
      <div class="message bot typing">
        <div class="typing-indicator">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
      }
    </div>

    <!-- --------------------------------------------------------- -->
    <!-- âœï¸ CUADRO DE ENTRADA                                      -->
    <!-- --------------------------------------------------------- -->
    <div class="chat-input">
      <input
        type="text"
        [(ngModel)]="mensajeInput"
        (keypress)="handleKeyPress($event)"
        [disabled]="esperandoRespuesta"
        placeholder="Escribe tu mensaje aquÃ­..."
      />
      <button
        class="send-btn"
        (click)="enviarMensaje()"
        [disabled]="!mensajeInput.trim() || esperandoRespuesta"
      >
        Enviar
      </button>
    </div>
  </main>
</div>
